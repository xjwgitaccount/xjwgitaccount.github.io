!function(){"use strict";function o(o,t){var e,i,n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"GET",r=Object.assign({},a),c=[];for(var d in r){var s=r[d];null!=s&&c.push("".concat(d,"=").concat(encodeURIComponent(s)))}var g=c.join("&");null===(e=window)||void 0===e||null===(i=e.goldlog)||void 0===i||null===(n=i.record)||void 0===n||n.call(i,o,t,g,l)}function t(o,t){o&&t&&(o.classList?o.classList.add(t):o.className+=" ".concat(t))}var e=function(o){if(document.cookie.length>0){var t=document.cookie.indexOf(o+"=");if(-1!=t){t=t+o.length+1;var e=document.cookie.indexOf(";",t);return-1==e&&(e=document.cookie.length),decodeURI(document.cookie.substring(t,e))}}return""};function n(o,t,e){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",n=new Date;n.setTime(n.getTime()+24*e*60*60*1e3);var a=o+"="+t+";expires="+n.toUTCString()+";path=/";i.length&&(a=a+";domain="+i),document.cookie=a}function a(o){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},a(o)}function l(o){throw new TypeError('"'+o+'" is read-only')}var r=window,c=document,d=function(){var o,t,e=(null===(o=window)||void 0===o||null===(t=o.navigator)||void 0===t?void 0:t.userAgent)||"";try{return e.includes("compatible")&&e.includes("MSIE")}catch(o){return!1}}(),s="openWwWebOrClientPreferenceSetting",g=e(s),p=!g||"true"===g,m="useNativeIM",u="cntaobao",f="normal",w=function(o,t){o||(o=location&&location.search);var e=RegExp("[?&]"+t+"=([^&]*)").exec(o);return e&&decodeURIComponent(e[1].replace(/\+/g," "))},h=function(o){var t=w(o,"touid"),e=w(o,"gid")||"",i="https://market.m.taobao.com/app/im/chat/index.html?&uid="+encodeURIComponent(t)+"&gid="+e+"&type=web",n=-1!==o.split("&")[1].indexOf("touid=cntaobao")?i:"https://market.m.taobao.com/app/im/chat/index.html";window.open(n,"https://market.m.taobao.com/app/im/chat/index.html")},_=function(o){y._log("wwgw.light.openClient"),y._log("light.component.openClient");var t=document.createElement("iframe");t.src=o,document.body.appendChild(t),setTimeout((function(){t.parentNode.removeChild(t)}),500)},b=function(){try{return decodeURI((e("_nk_")||e("tracknick")||e("l")&&e("l").split("::")[0]||"").replace(/\\u/g,"%u"))}catch(o){return""}},v=b(),x=location.protocol+"//dispatch.taobao.com/getRealCid.aw?fromurl="+(location.hostname+location.pathname)+"&t="+e("t")+"&toId=",y={__clicktimeObj:{},data:{},__setIsOk:function(o){_addonIsOK=o},addonIsOK:function(o){return"function"==typeof o&&o.call(null,!0),!0},init:function(){var o,t=this;t._log("wwgw.light.pv"),t._log("light.component.init"),(o=document.createElement("style")).innerText='.ww-block {display: block;margin-top: 3px;}.ww-inline {display: inline-block;vertical-align: text-bottom;}.__ww-wrapper {position: relative;display: inline-block;}.__ww-icon {width: 20px;height: 20px;cursor: pointer;background-image: url("https://img.alicdn.com/imgextra/i4/O1CN01fs9XjM1WUmcvL2RC9_!!6000000002792-2-tps-40-40.png");background-size: cover;display: inline-block;}.__ww-drop-down {display: none;position: absolute;left: -100px;height: 78px;width: 212px;background-color: #FFFFFF;border: 1px solid rgba(0, 0, 0, 0.08);box-shadow: 0 12px 24px 0 rgba(0, 0, 0, 0.06);border-radius: 12px;}.__ww-wrapper:hover .__ww-drop-down {display: flex;align-items: center;justify-content: center;}.__ww-type-selection {height: 54px;width: 94px;border-radius: 6px;display: flex;flex-direction: column;justify-content: center;align-items: center;cursor: pointer;}.__ww-type-selection span {width: 70px;}.__ww-type-selection:hover {background-color: #F5F5F5;}',document.head.appendChild(o),t.light(),window.___clearCountTimer||(window.___clearCountTimer=setInterval((function(){t.__clicktimeObj={}}),1e4))},light:function(t){var e=(document.querySelector(t)||c.body).querySelectorAll(".J_WangWang")||[],i=Array.prototype.slice.call(e),n=this,a=i.length;if(o("/CHAT_BC.light.wangwang_len","EXP",{len:a}),0!==a){for(var l=[],r=[],d=0;d<a;++d){var s=n._getParamsFromData(i[d]);l.push(s),r.push(encodeURIComponent(s.nick))}u=l[0].from||u,i.map((function(o,t){0==o.querySelectorAll(".__ww-icon").length&&n._lightToken(o,l[t],1)}))}},_lightToken:function(e,i,n){var c=this,d=document.createElement("div");t(d,"__ww-wrapper");var s=document.createElement("a"),g=document.createElement("div");t(g,"__ww-drop-down");var m=document.createElement("div");t(m,"__ww-type-selection"),m.innerHTML='<span style="font-weight: 500; color: #111;">使用客户端</span><span style="font-weight: 400;color: #c0c0c0;">多功能</span>';var w=document.createElement("div");t(w,"__ww-type-selection"),w.innerHTML='<span style="font-weight: 500; color: #111;">使用网页版</span><span style="font-weight: 400;color: #c0c0c0;">免下载</span>';var h=i.nick,_=i.item,v=i.items,y=i.from,C=i.portal,k=i.display,I=i.icon,T=i.scene,W=i.source,E=void 0===W?"light":W,O=i.client,S=i.toRole,D=i.extra,B=i.encode,A=i.sceneParam,P=i.showdropdown,X=B?decodeURIComponent(h):h,J=y?u:y,N=X.startsWith(J)?X:J+X,j=N;if(u=J,_&&(j+="-{"+_+"}"),c.data[j]={key:j,userName:X,userId:N,fromSite:J,status:2,itemId:_,itemsId:v,portalId:C,scene:T,toRole:S,source:E,client:O,sceneParam:A},t(e,"ww-light"),t(e,"ww-"+I),s.setAttribute("href","javascript: void(0)"),t(s,"__ww-icon"),t(s,"ww-online"),t(s,"ww-"+k),"object"===a(D))for(var H in D)D[H];var L=function(t){t.preventDefault();try{var i=c.__clicktimeObj&&c.__clicktimeObj[j]&&c.__clicktimeObj[j];if(o("/CHAT_BC.ww-light.over_click_times","CLK",{times:i}),i>=3&&!window.___show_confirm&&(o("/CHAT_BC.ww-light.confirm_jump_web","EXP"),confirm("没有安装阿里旺旺或千牛客户端？尝试一下网页版阿里旺旺，免安装")))return o("/CHAT_BC.ww-light.confirm_jump_web","CLK"),window.___show_confirm=!0,void R(t);c.__clicktimeObj[j]=(c.__clicktimeObj[j]||0)+1}catch(o){console.log(o)}c._log("wwgw.1.37"),c._log("wwgw.light.click"),c._log("light.component.Click_Total");var a,d=c.data[j],g=b(),p="";if(!d.dispatched&&n<4&&-1==d.userId.indexOf(":")){try{p=0===location.href.indexOf("//trade.taobao.com/")||-1!==location.href.indexOf("//list.taobao.com/")||0===location.href.indexOf("//list.tmall.com/search_product.htm")||0===location.href.indexOf("//s.taobao.com/")?"":"&clientX="+t.clientX+"&clientY="+t.clientY,0!==location.href.indexOf("//detail.taobao.com/")&&0!==location.href.indexOf("//item.taobao.com/")||(p+="&itemId="+_||0);var m=function(o){var t=o.target||o.srcElement;if(-1===location.href.indexOf("itemlist/list_bought_items")&&-1===location.href.indexOf("itemlist/listBoughtItems.htm"))return"";for(;"TBODY"!==t.nodeName;)t.parentNode,l("node");return t.getAttribute("data-status")}(t);m&&(p+="&orderStatus="+m)}catch(o){}var f=x+encodeURIComponent(d.userId)+"&charset=utf-8"+p+"&fromId="+u+encodeURIComponent(g);(a=f,new Promise((function(o,t){var e=document.createElement("script");e.src=a,e.async=!0,e.onerror=t,e.onload=e.onreadystatechange=function(){var t=this.readyState;t&&"loaded"!==t&&"complete"!==t||(e.onload=e.onreadystatechange=null,o())},document.head.appendChild(e)}))).then((function(){var o;(o=decodeURIComponent(r.realcid))&&o!==d.userId&&(d.userName=o.substring(8),d.userId=o),d.dispatched=!0,c._openChatDialog(d,s,e)})).catch((function(){}))}else c._openChatDialog(d,s,e)},R=function(t){o("/CHAT_BC.ww-light.open_type","CLK",{type:"web"}),f="web",L(t)};s.addEventListener("click",L,!0),m.addEventListener("click",(function(t){o("/CHAT_BC.ww-light.open_type","CLK",{type:"client"}),f="client",L(t)})),w.addEventListener("click",R),g.appendChild(m),g.appendChild(w),d.appendChild(s),P&&p&&d.appendChild(g),e.appendChild(d)},_isOtherHost:function(){for(var o=location.hostname,t=["tmall.net","tmall.com","taobao.com","daily.taobao.net"],e=t.length,i=0;i<e;i++)if(o.indexOf(t[i])>-1)return!1;return!0},_paramUserInfo:function(o,t,e){console.log(o);var i=o.userId||o.siteid+o.touid,n="";return t&&(i=encodeURIComponent(i)),e&&e.parentNode&&(n=e.parentNode.getAttribute("data-items")||""),"&touid="+i+"&siteid="+(o.fromSite||o.siteid)+"&status="+o.status+"&portalId="+(o.portalId||"")+"&gid="+(o.itemId||"")+"&itemsId="+n+"&scene="+(o.scene||"")+"&toRole="+(o.toRole||"")+"&source="+(o.source||"")+"&sceneparam="+o.sceneParam},_openChatDialog:function(t,i,a){var l=this;l.userInfo=t,l.link=i;var r="aliim:sendmsg?"+l._paramUserInfo(t,null,i);switch(f){case"web":h(r),f="",n(s,"false",7),n(m,"false",7,"taobao.com");break;case"client":_(r),f="",n(s,"fasle",7),n(m,"true",7,"taobao.com");break;default:!function(t){var i,n=!(!window.lib||!window.lib.mtop);o("/CHAT_BC.Ding_PaaS.PC_webww_url","CLK",{mtop:n,url:window.location.href});try{i="true"===e(m)}catch(o){i=!1}if(!function(){var o,t,e;try{var i=window.location.href;e=-1!==i.indexOf("trade.taobao.com/trade/detail/trade_order_detail")||-1!==i.indexOf("myseller.taobao.com"),o=-1!==i.indexOf("rate.taobao.com/RateDetailSeller"),t=-1!==i.indexOf("refund2.taobao.com/dispute/detail.htm")}catch(i){e=!1,o=!1,t=!1}return!(d||e||o||t)}())return _(t);if(e(m)&&!i)return h(t);if(!e(m)&&n){var a=window.location.hostname;lib.mtop.config.prefix=a.includes(".tmall.")?"h5api":"acs",lib.mtop.config.subDomain="m",lib.mtop.config.mainDomain=a.includes(".tmall.com")?"tmall.com":a.includes(".tmall.hk")?"tmall.hk":"taobao.com",window.lib.mtop.request({api:"mtop.taobao.alimp.bentley.personalconfig.query",v:"1.0",data:{configDomain:"userMsgCategoryRejectSettings",configId:"PC_WEB_CALL_WW_CLIENT"},dataType:"json"}).then((function(o){try{var e=o.data.model.data||"{}",n=JSON.parse(e);return(i=!n.pushSettings[0].enable)?_(t):h(t)}catch(o){return h(t)}}),(function(e){o("/CHAT_BC.Ding_PaaS.PC_setting_error","CLK",{err:JSON.stringify(e),url:window.location.href}),h(t)}))}_(t)}(r)}},_getParamsFromData:function(o){var t,e=function(o){var t={};if(!o.hasAttributes())return t;for(var e=o.attributes,i=0;i<e.length;i++){var n=e[i];t[n.name]=n.value}return t}(o)||{},i=e||{},n=i["data-nick"],a=i["data-encode"],l=void 0!==a&&a,c=i["data-item"],d=void 0===c?"":c,s=i["data-items"],g=void 0===s?"":s,p=i["data-display"],m=void 0===p?"inline":p,u=i["data-icon"],f=void 0===u?"large":u,w=i["data-from"],h=void 0===w?"cntaobao":w,_=i["data-portal"],b=void 0===_?"":_,v=i["data-scene"],x=void 0===v?"":v,y=i["data-toRole"],C=void 0===y?"":y,k=i["data-torole"],I=void 0===k?"":k,T=i["data-sceneparam"],W=void 0===T?"":T,E=i["data-extra"],O=void 0===E?"":E,S=i["data-showdropdown"],D=void 0!==S&&S,B={nick:l?decodeURIComponent(n):n,item:d||(r.g_config||{}).itemId||"",items:g,display:m,icon:f,from:h,portal:b,fromId:b||"",scene:x,toRole:C||I||"",source:"light",client:"false",encode:l,sceneParam:W,showdropdown:D};try{t=JSON.parse(decodeURIComponent(O))}catch(o){}return t&&(B.extra=t),B},_log:function(o,t){!function(o){try{(new Image).src=o}catch(o){}}("//gm.mmstat.com/"+o+"?cache="+Math.floor(-8888888*Math.random()+9999999)+"&wwnick="+u+v)}};function C(o){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},C(o)}new Promise((function(t,e){o("/CHAT_BC.light.light_source","EXP",{url:location.href.replace(location.search,"")}),e("old")})).then((function(){var t,e,i,n,a;o("/CHAT_BC.ww-light.light_exp","EXP"),window.Light=y,t=[],e=!1,i=!1,n=function(){if(!e){e=!0;for(var o=0;o<t.length;o++)t[o].fn.call(window,t[o].ctx);t=[]}},a=function(){"complete"===document.readyState&&n()},window.__light__doc__ready=function(o,l){if("function"!=typeof o)throw new TypeError("callback for docReady(fn) must be a function");e?setTimeout((function(){o(l)}),1):(t.push({fn:o,ctx:l}),"complete"===document.readyState||!document.attachEvent&&"interactive"===document.readyState?setTimeout(n,1):i||(document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):(document.attachEvent("onreadystatechange",a),window.attachEvent("onload",n)),i=!0))},window.__light__doc__ready((function(){y.init()}))})).catch((function(){var o=KISSY;function t(o,t){o||(o=location&&location.search);var e=RegExp("[?&]"+t+"=([^&]*)").exec(o);return e&&decodeURIComponent(e[1].replace(/\+/g," "))}function e(o){var t,e,i,r,c,d=!(!window.lib||!window.lib.mtop),s="&mtop="+d+"&url="+window.location.href;window.goldlog&&window.goldlog.record("/CHAT_BC.Ding_PaaS.PC_webww_url","CLK",s,"GET");try{var g=navigator.userAgent;t=g.indexOf("compatible")>-1&&g.indexOf("MSIE")>-1,e="true"===l("useNativeIM")}catch(o){t=!1,e=!1}try{var p=window.location.href;i=-1!==p.indexOf("trade.taobao.com/trade/detail/trade_order_detail")||-1!==p.indexOf("myseller.taobao.com"),r=-1!==p.indexOf("rate.taobao.com/RateDetailSeller"),c=-1!==p.indexOf("refund2.taobao.com/dispute/detail.htm")}catch(o){i=!1,r=!1}if(t||i||r||c)a(o);else if(l("useNativeIM")&&!e)n(o);else if(!l("useNativeIM")&&d){var m=window.location.hostname;lib.mtop.config.prefix=-1!==m.indexOf(".tmall.")?"h5api":"acs",lib.mtop.config.subDomain="m",lib.mtop.config.mainDomain=-1!==m.indexOf(".tmall.com")?"tmall.com":-1!==m.indexOf(".tmall.hk")?"tmall.hk":"taobao.com",window.lib.mtop.request({api:"mtop.taobao.alimp.bentley.personalconfig.query",v:"1.0",data:{configDomain:"userMsgCategoryRejectSettings",configId:"PC_WEB_CALL_WW_CLIENT"},dataType:"json"}).then((function(t){try{var i=t.data.model.data,l=JSON.parse(i);(e=!l.pushSettings[0].enable)?a(o):n(o)}catch(t){n(o)}}),(function(t){var e="&err="+JSON.stringify(t)+"&url="+window.location.href;window.goldlog&&window.goldlog.record("/CHAT_BC.Ding_PaaS.PC_setting_error","CLK",e,"GET"),n(o)}))}else a(o)}function n(o){var e=t(o,"touid"),i=t(o,"gid")||"",n="https://market.m.taobao.com/app/im/chat/index.html?&uid="+encodeURIComponent(e)+"&gid="+i+"&type=web",a=-1!==o.split("&")[1].indexOf("touid=cntaobao")?n:"https://market.m.taobao.com/app/im/chat/index.html";window.open(a,"https://market.m.taobao.com/app/im/chat/index.html")}function a(o){Light._log("wwgw.light.openClient"),Light._log("light.component.openClient");var t=document.createElement("iframe");t.src=o,document.body.appendChild(t),setTimeout((function(){t.parentNode.removeChild(t)}),500)}function l(o){if(document.cookie.length>0){var t=document.cookie.indexOf(o+"=");if(-1!=t){t=t+o.length+1;var e=document.cookie.indexOf(";",t);return-1==e&&(e=document.cookie.length),unescape(document.cookie.substring(t,e))}}return""}parseFloat(o.version)>=1.4&&o.config({modules:{ajax:{alias:["io"]}}}),o.use("dom,event,cookie,ajax,ua",(function(o,t,n,a,l,r){var c,d,s,g=t||o.DOM,p=n||o.Event,m=a||o.Cookie,u=l||o.IO||o.Ajax,f=r||o.UA,w=!1,h=window,_=document,b=(window.localStorage,encodeURIComponent),v=decodeURIComponent,x=o.now(),y=unescape((m.get("_nk_")||m.get("tracknick")||m.get("l")&&m.get("l").split("::")[0]||"").replace(/\\u/g,"%u")),k=(o.unparam(location.search.replace(/^\?/,"")).id,"x"),I=h.navigator.userAgent,T=/Windows NT 6.2/g.test(I),W=f.ie||/MSIE ([^;]*)|Trident.*; rv(?:\s|:)?([0-9.]+)/.test(I),E=(I.indexOf("Edge"),/tablet/i.test(I)),O=h.g_config||{},S=0,D=((s=location.hostname).indexOf("tmall.com")>-1?(d="tmall.com",k="otherx"):s.indexOf("daily.tmall.net")>0?(d="daily.tmall.net",k="otherx"):d=s.indexOf("taobao.net")>0?"taobao.net":"taobao.com",d),B=/daily/i.test(location.host)?"daily.taobao.net":"taobao.com",A="cntaobao",P=function(){return!!m.get("_l_g_")},X=6,J=6===(h.g_config||0).appId,N=location.protocol+"//amos.alicdn.com/getcid.aw?v=3&groupid=0&s=1&charset=utf-8",j=(location.protocol,location.protocol+"//dispatch.taobao.com/getRealCid.aw?fromurl="+(location.hostname+location.pathname)+"&t="+m.get("t")+"&toId="),H="//log.mmstat.com/ww?cache="+x,L=(location.protocol,["ie","firefox","chrome","safari","opera"]),R=[1,2,10,8,12,12,12],U={__clicktimeObj:{},__setIsOk:function(o){c=o},addonIsOK:function(t){var e=this;return location.href.indexOf("topen")>-1?(t&&t.call(null,!1),c=!1,window.goldlog&&window.goldlog.record("/CHAT_BC.light.addon_topen","EXP","","GET"),window.goldlog&&window.goldlog.record("/CHAT_BC.light.addon_val","EXP","&value=false","GET"),!1):1==o.unparam(m.get("x")).c?(t&&t.call(null,!0),c=!0,window.goldlog&&window.goldlog.record("/CHAT_BC.light.x_c","EXP","","GET"),window.goldlog&&window.goldlog.record("/CHAT_BC.light.addon_val","EXP","&value=true","GET"),!0):(o.isBoolean(c)?(window.goldlog&&window.goldlog.record("/CHAT_BC.light.addon_val","EXP","&value="+c,"GET"),t&&t.call(null,c)):this._checkWangWangInstalled((function(o){o||e._log("wwgw.light.notInstallClient"),c=o,window.goldlog&&window.goldlog.record("/CHAT_BC.light.addon_val","EXP","&value="+c,"GET"),t&&t.call(null,c)})),t?void 0:(window.goldlog&&window.goldlog.record("/CHAT_BC.light.addon_val","EXP","&value="+c,"GET"),c))},data:{},lightedUsers:[],init:function(){var o=this;o._log("wwgw.light.pv"),o._log("light.component.init"),g.addStyleSheet('.ww-light{overflow:hidden;}.ww-block{display:block;margin-top:3px;}.ww-inline{display:inline-block;vertical-align:text-bottom;}.ww-light a{background-image: url("//img.alicdn.com/tps/i1/T15AD7FFFaXXbJnvQ_-130-60.gif");background-image: -webkit-image-set(url("//img.alicdn.com/tps/i1/T15AD7FFFaXXbJnvQ_-130-60.gif") 1x,url("//img.alicdn.com/tps/i4/T1Rsz7FPJaXXbZhKn7-520-240.gif") 4x);background-image: -moz-image-set(url("//img.alicdn.com/tps/i1/T15AD7FFFaXXbJnvQ_-130-60.gif") 1x,url("//img.alicdn.com/tps/i4/T1Rsz7FPJaXXbZhKn7-520-240.gif") 4x);background-image: -o-image-set(url("//img.alicdn.com/tps/i1/T15AD7FFFaXXbJnvQ_-130-60.gif") 1x,url("//img.alicdn.com/tps/i4/T1Rsz7FPJaXXbZhKn7-520-240.gif") 4x);background-image: -ms-image-set(url("//img.alicdn.com/tps/i1/T15AD7FFFaXXbJnvQ_-130-60.gif") 1x,url("//img.alicdn.com/tps/i4/T1Rsz7FPJaXXbZhKn7-520-240.gif") 4x);text-decoration:none!important;width:20px;height:20px;zoom:1;}.ww-large a{width:67px;}a.ww-offline{background-position:0 -20px;}a.ww-mobile{background-position:0 -40px;}.ww-small .ww-online{background-position:-80px 0;}.ww-small .ww-offline{background-position:-80px -20px;}.ww-small .ww-mobile{background-position:-80px -40px;}.ww-static .ww-online{background-position:-110px 0;}.ww-static .ww-offline{background-position:-110px -20px;}.ww-static .ww-mobile{background-position:-110px -40px;}.ww-light a span{display:none;}'),o.light();for(var t=0,e=L.length;t<e;++t)if(f[L[t]]){S=L[t]+f[L[t]];break}window.___clearCountTimer||(window.___clearCountTimer=setInterval((function(){o.__clicktimeObj={}}),1e4))},initStart:function(){var t=this;if(!J){var e=o.unparam(location.search.substring(1));("g_config"in h&&"appId"in h.g_config&&-1!=h.g_config.appId||"tstart"in e||"tdog"in e)&&o.ready((function(){var o,e,i,n,a=_.getElementsByTagName("head")[0]||_.documentElement,l=(_.createElement("link"),_.createElement("script")),r=(o=2,(n=(i=(e=e||location.hostname).split(".")).length)<=2?e:((o=o||1)>n-2&&(o=n-2),i.slice(o).join("."))),c=/daily/i.test(location.host)?"assets.daily.taobao.net/g":"g.alicdn.com",d=location.protocol+"//"+c+"/aliww/web.ww.im/0.2.1/scripts/adapter.js";"etao.com"!=r&&(l.src=d,a.insertBefore(l,a.firstChild),!t.addonIsOK()&&h.g_config.toolbar&&h.g_config.toolbar.delay&&(h.g_config.toolbar.delay=0))}))}},light:function(t){t=g.get(t)||_.body;var e=this,i=g.query(".J_WangWang",t),n=i.length;if(0!==n){window.goldlog&&window.goldlog.record("/CHAT_BC.light.wangwang_len","EXP","&len="+n,"GET");var a,l,r,c=[],d=[];for(r=0;r<n;++r)l=e._getParamsFromData(i[r]),c.push(l),a=l.nick,d.push(b(a));A=c[0].from||A;var s,p,m=[],u=[],f=[],w="",h=0,v=0;for(s=0;s<n;++s)((w+d[s]).length>1800||s-100*v>=100||s===n-1)&&(p=s===n-1?n:s,u[v]=d.slice(h,p),m[v]=i.slice(h,p),f[v]=c.slice(h,p),w="",h=s,v++),w+=d[s]+";";var x=0;!function t(i){(function(t,i,n,a){a&&e._log("wwgw.light.degradeCount"),o.each(t,(function(o,t){if(0==g.query("a",o).length){var l=a?1:n[t];e._lightToken(o,i[t],l)}}))})(m[i],f[i],[],!0),++x<v&&t(++i)}(0)}},_lightToken:function(t,i,n){var a=this,l=g.create('<a href="javascript: void(0);" target="_blank"></a>'),r=i.from,c=i.encode?v(i.nick):i.nick,d=r+c,s=i.item,f=i.items,w=i.portal,_=i.extra,x=d;A=r,s&&(x+="-{"+s+"}"),a.data[x]={key:x,userName:c,userId:d,fromSite:r,status:R[n],itemId:s,itemsId:f,portalId:w},t.className="ww-light ww-"+i.icon,l.className="ww-"+i.display,1===n?(g.addClass(l,"ww-online"),l.title="点此可以直接和卖家交流选好的宝贝，或相互交流网购体验，还支持语音视频噢。",O.appId&&4==O.appId&&(l.title="我在线，和我聊聊吧~"),l.innerHTML="<span>旺旺在线</span>"):4===n||5===n?(g.addClass(l,"ww-mobile"),l.innerHTML="<span>手机在线</span>"):(g.addClass(l,"ww-offline"),l.innerHTML="<span>旺旺离线</span>");var I="";if("object"===C(_))for(var W in _)I+="&"+W+"="+_[W];l.href=N+"&uid="+encodeURIComponent(c)+"&site="+r+"&fromid="+r+y+I,p.on(l,"click",(function(t){try{if(a.__clicktimeObj&&a.__clicktimeObj[x]&&a.__clicktimeObj[x]>=10&&!window.____hasAlert)return alert("如果无法打开聊天窗口，请确保已经安装阿里旺旺或千牛客户端"),window.____hasAlert=!0,void t.preventDefault();a.__clicktimeObj[x]=(a.__clicktimeObj[x]||0)+1}catch(o){console.log(o)}a._log("wwgw.1.37"),a._log("wwgw.light.click"),a._log("light.component.Click_Total");var i=o.unparam(m.get(k)),r=a.data[x],c=unescape((m.get("_nk_")||m.get("tracknick")||m.get("l")&&m.get("l").split("::")[0]||"").replace(/\\u/g,"%u"));if((a.addonIsOK()||i&&1==i.e)&&t.preventDefault(),!a.addonIsOK()&&(t.preventDefault(),a._isOtherHost()))return window.goldlog&&window.goldlog.record("/CHAT_BC.light.click_otherhost","EXP","&windows8="+T,"GET"),void(T?e("aliim:sendmsg?"+a._paramUserInfo(r,null,l)):(e("aliim:sendmsg?"+a._paramUserInfo(r,null,l)),alert("如果您还未安装阿里旺旺,请下载阿里旺旺!"),window.open("//www.taobao.com/wangwang")));var d="";if(!r.dispatched&&n<4&&-1==r.userId.indexOf(":")){try{d=0===location.href.indexOf("//trade.taobao.com/")||-1!==location.href.indexOf("//list.taobao.com/")||0===location.href.indexOf("//list.tmall.com/search_product.htm")||0===location.href.indexOf("//s.taobao.com/")?"":"&clientX="+t.clientX+"&clientY="+t.clientY,0!==location.href.indexOf("//detail.taobao.com/")&&0!==location.href.indexOf("//item.taobao.com/")||(d+="&itemId="+s||0);var g=function(o){var t=o.target||o.srcElement;if(-1===location.href.indexOf("itemlist/list_bought_items")&&-1===location.href.indexOf("itemlist/listBoughtItems.htm"))return"";for(;t&&"TBODY"!==t.nodeName;)t=t.parentNode;return t.getAttribute("data-status")}(t);g&&(d+="&orderStatus="+g)}catch(o){}u.getScript(j+b(r.userId)+"&charset=utf-8"+d+"&fromId="+A+b(c),(function(){var o=v(h.realcid);o&&o!==r.userId&&(r.userName=o.substring(8),r.userId=o),r.dispatched=!0,a._openChatDialog(r,l)}),"utf-8")}else a._openChatDialog(r,l)})),t.appendChild(l)},_directToTBLogin:function(t){var e=location,i=e.protocol+"//"+e.host+e.pathname,n=e.search,a=e.hash,l=e.href,r="wwlight",c="https://login."+B+"/member/login.jhtml?f=top";r in(n=n?o.unparam(n.substring(1)):{})&&delete n[r],t&&(n[r]=t),n=o.param(n),l=b(l=i+"?"+n+a),e.href=c+"&redirectURL="+l},_openTBLoginPopup:function(t){var e,i=(d=location).protocol+"//"+d.host+d.pathname,n=d.search,a=d.hash,l=d.href,r="wwlight",c=location.hostname.indexOf("taobao.com")>-1;r in(n=n?o.unparam(n.substring(1)):{})&&delete n[r],t&&(n[r]=t,this.isSearch()?(e=n.q,delete n.q,n[r]=t):n[r]=t),n=o.param(n),this.isSearch()&&e&&(n="q="+e+"&"+n),l=i+"?"+n+a;var d=location;g.addStyleSheet(".tstart-login{width:410px;height:300px;bottom:100px;left:200px;opacity:1;position:fixed;_position:absolute;z-index:100000000;background-color:#fff;padding:0;overflow:hidden;-moz-border-radius-bottomleft:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-topleft:5px;-moz-border-radius-topright:5px;border:7px solid #BBB;}.tstart-login .hd{height:22px;line-height:22px;padding-left:8px;border-bottom:1px solid #D1D1D1;font-weight:bold;background-color:#fff;}.tstart-login .ft{background-color:#F5F5F5;}.tstart-login .ft .btn-close{color:#C9C9C9;font-family:Tahoma,sans;font-size:12px;font-weight:bold;position:absolute;right:8px;text-decoration:none;top:3px;}");var s=g.get(".tstart-login");function m(t){g.css(t,"left",parseInt(g.viewportWidth()/2)-parseInt(s.offsetWidth/2)+"px"),g.css(t,"top",parseInt(g.viewportHeight()/2)-parseInt(s.offsetHeight/2)+(6===o.UA.ie?g.scrollTop():0)+"px")}if(s)g.css(s,"display","block"),m(s);else{if(s=g.create('<div id="tstartLogin" class="tstart-login"><div class="hd"><h3></h3></div><div class="bd" style="padding: 0px; overflow: hidden;"><iframe width="410" height="270" frameborder="0" scrolling="no" id="frameContent" name="frameContent" ></iframe></div><div class="ft"><a class="btn-close" title="关闭此窗口" href="javascript:void(0)">x</a></div></div>'),document.body.appendChild(s),m(s),p.on(g.get(".btn-close",s),"click",(function(){g.css(s,"display","none")})),6===o.UA.ie?p.on(window,"scroll resize",(function(){m(s)})):p.on(window,"scroll resize",(function(){g.css(s,"left",parseInt(g.viewportWidth()/2)-parseInt(s.offsetWidth/2)+"px")})),c)u="//www.taobao.com/go/act/share/loginsuccess.php";else var u="//www.daily.taobao.net/go/act/share/loginsuccess.php";var f="https://login."+B+"/member/login.jhtml?style=mini&full_redirect=false&redirect_url="+u,w=s.getElementsByTagName("iframe")[0];w.src=f,p.on(w,"load",(function(){P()&&(location.href=l)}))}},_isOtherHost:function(){var o=location.hostname,t=["tmall.net","tmall.com","taobao.com","daily.taobao.net"],e=t.length;for(i=0;i<e;i++)if(o.indexOf(t[i])>-1)return!1;return!0},isSearch:function(){var o,t=["search.taobao.com","sandbox.search.taobao.com","search8.taobao.com","search8.daily.taobao.net","s.taobao.com","list.mall.daily.taobao.net","list.mall.taobao.com","s8.taobao.com","list.tmall.com","list.daily.tmall.net"],e=t.length,i=location;for(o=0;o<e;o++)if(i.host.indexOf(t[o]>-1))return!0},_paramUserInfo:function(o,t,e){var i=o.userId||o.siteid+o.touid,n="";return t&&(i=b(i)),6!=X?"uid="+i.split("cntaobao")[1]+"&tositeid="+o.fromSite+"&status="+o.status+"&suid="+o.portalId:(e&&e.parentNode&&(n=e.parentNode.getAttribute("data-items")||""),"&touid="+i+"&siteid="+(o.fromSite||o.siteid)+"&status="+o.status+"&portalId="+(o.portalId||"")+"&gid="+(o.itemId||"")+"&itemsId="+n)},_openChatDialog:function(t,i){var n=this,a=1;if(n.userInfo=t,n.link=i,n.addonIsOK()){if(W)try{new ActiveXObject("AliIMX.WangWangX").ExecCmd("Aliim:sendmsg?"+n._paramUserInfo(t,!0,i))}catch(o){e("aliim:sendmsg?"+n._paramUserInfo(t,null,i))}else n._openChatDialogInUnIE(t,i);a=0}else if(w)if(f.firefox){var l=g.get("#J_WebWangWangPluginNotice");window.goldlog&&window.goldlog.record("/CHAT_BC.light.notice_pop_up","EXP","","GET"),l?(g.css(l,"display","block"),g.css("#J_WebWangWangPluginNoticeMask","display","block")):(document.body.appendChild(g.create('<div id="J_WebWangWangPluginNoticeMask" style="background-color:#000;opacity:.6;position:fixed;width:100%;height:100%;left:0;top:0;z-index:100000004"></div><div id="J_WebWangWangPluginNotice" class="webww-plugin-notice" style="background-color:#fff;position:fixed;width:400px;height:120px;z-index:100000005;text-align:center;margin-left:-200px;left:50%;top:50%;margin-top:-60px"><div class="webww-plugin-notice-content" style="padding:15px;line-height:80px">亲，您当前浏览器未开启旺旺插件，<a href="//bangpai.taobao.com/group/thread/15625975-291119934.htm?spm=0.0.0.0.PBQheF" target="_blank">点此查看开启旺旺插件教程</a></div><div class="webww-plugin-notice-footer" style="padding:10px;height:20px;background-color:#eaeaea;cursor:pointer">取消<div></div>')),l=g.get("#J_WebWangWangPluginNotice"),p.on(l,"click",(function(o){g.hasClass(o.target,"webww-plugin-notice-footer")&&(g.css(l,"display","none"),g.css("#J_WebWangWangPluginNoticeMask","display","none"))})))}else try{n._openChatDialogInUnIE(t,i)}catch(o){}else{if(!T)return void n._openWebWW();if(E)n._openDialogBySelectionDialog(t,i,2);else{var r=o.unparam(m.get(k)).c;r>1?n._openDialogBySelectionDialog(t,i,r):n._createSelectionDialog()}}F(H+"&uid="+y+"&tid="+t.userId+"&gid="+t.itemId+"&ver="+a+"&browse="+S+"&playform="+navigator.platform)},_openWebWW:function(t){var i=this,n=i.userInfo,a=o.unparam(m.get(k));P()?a&&1==a.e?(i._isOtherHost()?e("aliim:sendmsg?"+i._paramUserInfo(n,null,t)):window.TDog&&TDog.EventCenter&&(i._log("wwgw.light.webChat"),TDog.EventCenter.fire(TDog.EVENTS.CLICK_LIGHT_ICON,{userInfo:n})),F(H+"&uid="+y+"&tid="+n.userId+"&gid="+n.itemId+"&ver=2&browse="+S+"&playform="+navigator.platform)):window.TDog&&TDog.EventCenter?(i._log("wwgw.light.webChat"),TDog.EventCenter.fire(TDog.EVENTS.CLICK_LIGHT_ICON,{userInfo:n})):i._directToTBLogin(n.key):i._directToTBLogin(n.key)},_openChatDialogInUnIE:function(o,t){var i=this;if(i.plugin){window.goldlog&&window.goldlog.record("/CHAT_BC.light.open_client_plugin","EXP","","GET");var n="function"==typeof i.plugin.NPWWVersion;if(f.webkit&&n&&i.numberify(i.plugin.NPWWVersion())<1.005)e("aliim:sendmsg?"+i._paramUserInfo(o,null,t));else try{var a="aliim:sendmsg?"+i._paramUserInfo(o,!0,t);i.plugin.SendCommand(a,1)}catch(n){e("aliim:sendmsg?"+i._paramUserInfo(o,null,t))}}else window.goldlog&&window.goldlog.record("/CHAT_BC.light.open_client_noplugin","EXP","","GET"),e("aliim:sendmsg?"+i._paramUserInfo(o,null,t))},_createSelectionDialog:function(){window.goldlog&&window.goldlog.record("/CHAT_BC.light.selection_dialog","EXP","","GET");var t=this,e=o.unparam(m.get(k));if(t.selectionDialog)(i=t.selectionDialog).style.display="block";else{g.addStyleSheet("#J_Windows8_Selection_Dialog{display:block;width:440px;height:270px;position:fixed;top: 50%;left:50%;margin:-134px 0 0 -220px;padding:0;z-index:100000001;}#J_Windows8_Selection_Dialog_Bg{width:100%;height:100%;background:#000;opacity:0.2;filter:alpha(opacity=20);position:fixed;left:0;top:0;z-index:100000000;}#J_Windows8_Selection_Dialog .win8-dialog-bg{display:block;width: 440px;height:270px;background:#000;opacity:0.2;filter:alpha(opacity=20);position:absolute;top:0;left:0;padding:0;margin:0;}#J_Windows8_Selection_Dialog .win8-dialog-con{display:block;margin:5px;width:390px;height:220px;background:#fff;position:absolute;top:0;left:0;font:14px/1.5 Microsoft YaHei;padding:20px;}#J_Windows8_Selection_Dialog h4{font-size:18px;font-weight:bold;padding:0;margin:0;color:#000;}#J_Windows8_Selection_Dialog ul{padding:15px 0 30px 20px;margin:10px 0 0 0;}#J_Windows8_Selection_Dialog li{padding:0 0 0 40px;margin:0;list-style:none;background:url('//gtd.alicdn.com/tps/i2/T1pEcjXdRhXXcCnGHx-30-300.png') no-repeat 0 2px;height:30px;line-height:30px;font-size: 16px;color: #000;cursor:pointer;}#J_Windows8_Selection_Dialog li.win8-slt{background-position: 0 -45px;}#J_Windows8_Selection_Dialog li.win8-tip{background:none;cursor:default;font-size:12px;color:#666;line-height:16px;height:16px;margin-bottom:5px;}#J_Windows8_Selection_Dialog .win8-btn{font-size:14px;padding:30px 0 0 0;border-top:1px solid #ddd;}#J_Windows8_Selection_Dialog .win8-cb{display:block;float:left;margin:5px 50px 0 0;padding:0;}#J_Windows8_Selection_Dialog .win8-cb input{vertical-align:-1px;margin-right:5px;}#J_Windows8_Selection_Dialog .win8-btn a{display: block;float:left;width:96px;height:28px;background:#fff;border:2px solid #ddd;color:#737373;text-decoration:none;text-align:center;line-height:28px;font-size:16px;margin-right:15px;overflow:hidden;}#J_Windows8_Selection_Dialog .win8-btn a:hover{background:#00ade8;color:#fff;text-decoration:none;}#J_Windows8_Btn_Close{display:block;width:40px;height:40px;background:url('//gtd.alicdn.com/tps/i2/T1pEcjXdRhXXcCnGHx-30-300.png') no-repeat 8px -113px;position:absolute;top:0;right:0;text-indent:-9999px;}#J_Windows8_Btn_Close:hover{background-position:8px -188px}");var i=g.create('<div><div id="J_Windows8_Selection_Dialog_Bg" class="win8-bg"></div><div id="J_Windows8_Selection_Dialog"><div class="win8-dialog-bg"></div><div class="win8-dialog-con"><h4>请选择需要打开的旺旺：</h4><ul><li class="win8-slt J_Windows8_selection_item" data-value="2">阿里旺旺 for Windows 8</li><li class="win8-tip">如果未安装，请先在应用商店下载安装</li><li class="J_Windows8_selection_item" data-value="3">阿里旺旺网页版</li></ul><div class="win8-btn"><label class="win8-cb"><input type="checkbox" id="J_Window8_remember" />记住我的选择</label><a href="javascript:;" title="确定" id="J_Windows8_Btn_Yes">确定</a><a href="javascript:;" title="取消" id="J_Windows8_Btn_No">取消</a></div><a href="javascript:;" title="关闭" id="J_Windows8_Btn_Close">关闭</a></div></div></div>');t.selectionDialog=i,_.body.appendChild(i),p.on(i,"click",(function(n){var a=n.target;if("J_Windows8_Btn_Yes"===a.id){var l=g.attr(g.get(".win8-slt"),"data-value");g.get("#J_Window8_remember").checked?(e.c=parseInt(l),m.set(k,o.param(e),365,D,"/"),t._destorySelectionDialog()):i.style.display="none",t._openDialogBySelectionDialog(t.userInfo,t.link,l)}else"J_Windows8_Btn_No"===a.id||"J_Windows8_Btn_Close"===a.id?i.style.display="none":g.hasClass(a,"J_Windows8_selection_item")&&!g.hasClass("win8-slt")&&(g.addClass(a,"win8-slt"),g.removeClass(g.siblings(a),"win8-slt"))}))}},_destorySelectionDialog:function(){var o=this;g.remove(o.selectionDialog),p.remove(o.selectionDialog,"click"),o.selectionDialog=null},_openDialogBySelectionDialog:function(o,t,i){window.goldlog&&window.goldlog.record("/CHAT_BC.light.click_openDialogBySelectionDialog","EXP","","GET"),2==i?e("aliim:sendmsg?"+this._paramUserInfo(o,null,t)):3==i&&this._openWebWW(t)},_checkWangWangInstalled:function(t){var e=this,i=!1,n=(o.unparam(m.get(k)),navigator.platform.indexOf("Mac")>-1);if(this._log("wwgw.1.38"),location.href.indexOf("topen")>-1)return i=!1,void(t&&t.call(null,i));if(n)return i=!0,void(t&&t.call(null,i));if(!i&&W)return i=e._checkWangWangVersion(),t&&t.call(null,i),void(window.goldlog&&window.goldlog.record("/CHAT_BC.light.check_version_ie","EXP","&ret="+i,"GET"));if(navigator.mimeTypes["application/ww-plugin"]){var a=_.createElement("embed");if(a.setAttribute("type","application/ww-plugin"),g.css(a,"visibility","hidden"),g.css(a,"width",0),g.css(a,"height",0),_.body.appendChild(a),"function"==typeof a.NPWWVersion){var l=e.numberify(a.NPWWVersion());l>=1.003&&(i=!0),window.goldlog&&window.goldlog.record("/CHAT_BC.light.mime_NPWWVersion","EXP","&v="+l,"GET")}else w=!0,window.goldlog&&window.goldlog.record("/CHAT_BC.light.disable_ww_plugin","EXP","&disabledWangWangPlugin=true","GET");return e.plugin=a,window.goldlog&&window.goldlog.record("/CHAT_BC.light.mimetype","EXP","&ret="+i,"GET"),void(t&&t.call(null,i))}return this.localServer((function(o){o?t&&t.call(null,o):e.localServer((function(o){t&&t.call(null,o)}),"https:"==location.protocol?"4813":"4812")})),i&&this._log("wwgw.1.39"),i},localServer:function(o,t){setTimeout((function(){o(!0)}),1)},numberify:function(o){var t=0;return parseFloat(o.replace(/\./g,(function(){return 0==t++?".":""})))},_checkWangWangVersion:function(){var t=!0;o.unparam(m.get(k));try{new ActiveXObject("aliimx.wangwangx")}catch(o){try{new ActiveXObject("WangWangX.WangWangObj"),X=5}catch(o){t=!1}}return t},_getParamsFromData:function(o){var t=g.attr(o,"data-encode")||!1,e=g.attr(o,"data-nick")||"";t&&(e=v(e));var i,n={nick:e,item:g.attr(o,"data-item")||(h.g_config||{}).itemId||"",items:g.attr(o,"data-items")||"",display:g.attr(o,"data-display")||"inline",icon:g.attr(o,"data-icon")||"large",from:g.attr(o,"data-from")||"cntaobao",portal:g.attr(o,"data-portal")||"",fromId:g.attr(o,"data-portal")||"",encode:b},a=g.attr(o,"data-extra");try{i=JSON.parse(decodeURIComponent(a))}catch(o){}return i&&(n.extra=i),n},_log:function(o,t){F("//gm.mmstat.com/"+o+"?cache="+Math.floor(-8888888*Math.random()+9999999)+"&wwnick="+A+y)}};function F(o){try{(new Image).src=o}catch(o){}}window.Light=U,o.ready((function(){U.addonIsOK((function(){U.initStart()})),U.init()}))}))}))}();